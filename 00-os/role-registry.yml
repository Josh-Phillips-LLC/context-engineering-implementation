# Canonical Role Registry
# 
# This file is the single source of truth for Context-Engineering role metadata.
# All role wiring (workflows, compose files, scripts) is generated from this registry.
# 
# To add a new role:
# 1. Add an entry to the roles list below
# 2. Include git_identity (name + noreply email) for deterministic commit attribution
# 3. Run: 00-os/scripts/generate-role-wiring.py
# 4. Commit both the registry change and the generated outputs
# 
# DO NOT manually edit generated sections in target files.
# Update this registry and regenerate instead.

metadata:
  version: "1.0"
  last_updated: "2026-02-17"
  canonical_source: "00-os/role-registry.yml"
  generator_script: "00-os/scripts/generate-role-wiring.py"

roles:
  - slug: implementation-specialist
    display_name: Implementation Specialist
    shorthand: implementation
    repo_name: context-engineering-role-implementation-specialist
    git_identity:
      name: a-implementationspecialist[bot]
      email: 261284965+a-implementationspecialist[bot]@users.noreply.github.com
    
    # GitHub App configuration
    github_app:
      app_id_secret: IMPLEMENTATION_SPECIALIST_APP_ID
      app_id_value: 2852927
      private_key_secret: IMPLEMENTATION_SPECIALIST_APP_PRIVATE_KEY
      installation_id_secret: IMPLEMENTATION_SPECIALIST_APP_INSTALLATION_ID
      installation_id_value: 112286254
      env_prefix: IMPLEMENTATION
    
    # Docker Compose configuration
    compose:
      service_name: implementation-workstation
      profile: null  # No profile means default service
      image_suffix: implementation-specialist
      volume_prefix: implementation
    
    # Interactive selection
    menu_order: 1
    menu_label: "implementation"
    
  - slug: compliance-officer
    display_name: Compliance Officer
    shorthand: compliance
    repo_name: context-engineering-role-compliance-officer
    git_identity:
      name: a-complianceofficer[bot]
      email: 261288374+a-complianceofficer[bot]@users.noreply.github.com
    
    github_app:
      app_id_secret: COMPLIANCE_OFFICER_APP_ID
      app_id_value: 2853078
      private_key_secret: COMPLIANCE_OFFICER_APP_PRIVATE_KEY
      installation_id_secret: COMPLIANCE_OFFICER_APP_INSTALLATION_ID
      installation_id_value: 112284302
      env_prefix: COMPLIANCE
    
    compose:
      service_name: compliance-workstation
      profile: compliance-officer
      image_suffix: compliance-officer
      volume_prefix: compliance
    
    menu_order: 2
    menu_label: "compliance"
    
  - slug: systems-architect
    display_name: Systems Architect
    shorthand: systems-architect
    repo_name: context-engineering-role-systems-architect
    git_identity:
      name: a-systemsarchitect[bot]
      email: 261288710+a-systemsarchitect[bot]@users.noreply.github.com
    
    github_app:
      app_id_secret: SYSTEMS_ARCHITECT_APP_ID
      app_id_value: 2853089
      private_key_secret: SYSTEMS_ARCHITECT_APP_PRIVATE_KEY
      installation_id_secret: SYSTEMS_ARCHITECT_APP_INSTALLATION_ID
      installation_id_value: 112285784
      env_prefix: SYSTEMS_ARCHITECT
    
    compose:
      service_name: systems-architect-workstation
      profile: systems-architect
      image_suffix: systems-architect
      volume_prefix: systems_architect
    
    menu_order: 3
    menu_label: "systems-architect"

  - slug: hr-ai-agent-specialist
    display_name: HR and AI Agent Specialist
    shorthand: hraias
    repo_name: context-engineering-role-hr-ai-agent-specialist
    git_identity:
      name: a-hraiagentspecialist[bot]
      email: 262162836+a-hraiagentspecialist[bot]@users.noreply.github.com

    github_app:
      app_id_secret: HR_AI_AGENT_SPECIALIST_APP_ID
      app_id_value: 2885628
      private_key_secret: HR_AI_AGENT_SPECIALIST_APP_PRIVATE_KEY
      installation_id_secret: HR_AI_AGENT_SPECIALIST_APP_INSTALLATION_ID
      installation_id_value: 110711332
      env_prefix: HR_AI_AGENT_SPECIALIST

    compose:
      service_name: hr-ai-agent-specialist-workstation
      profile: hr-ai-agent-specialist
      image_suffix: hr-ai-agent-specialist
      volume_prefix: hr_ai_agent_specialist

    menu_order: 4
    menu_label: "hraias"

# Configuration templates for role wiring
templates:
  workflow_sync_matrix_item: |
    - role_slug: {{ slug }}
      repo_name: {{ repo_name }}
      app_id_secret: {{ github_app.app_id_secret }}
      private_key_secret: {{ github_app.private_key_secret }}
  
  workflow_publish_matrix_item: |
    - role_profile: {{ slug }}
      image_suffix: {{ compose.image_suffix }}
      role_repo: {{ repo_name }}
  
  workflow_dispatch_choice: "{{ slug }}"
  
  shell_case_implementation: |
    {{ menu_label }})
      ROLE_PROFILE="{{ slug }}"
      SERVICE_NAME="{{ compose.service_name }}"
      PROFILE_NAME="{{ compose.profile or '' }}"
      ROLE_ENV_PREFIX="{{ github_app.env_prefix }}"
      ;;
  
  shell_normalize_case: |
    {{ menu_label }}{{ '|' + slug if menu_label != slug else '' }}) echo "{{ menu_label }}" ;;
  
  compose_service_definition: |
    {{ compose.service_name }}:
      build:
        context: ..
        dockerfile: .devcontainer-workstation/Dockerfile
        args:
          IMAGE_ROLE_PROFILE: {{ slug }}
      container_name: {{ compose.service_name }}
      {% if compose.profile %}profiles:
        - {{ compose.profile }}
      {% endif %}volumes:
        - {{ compose.volume_prefix }}_projects_data:/workspace
        - {{ compose.volume_prefix }}_gh_config:/root/.config/gh
        - {{ compose.volume_prefix }}_git_config:/root/.config/git
        # - ssh_data:/root/.ssh
        - {{ compose.volume_prefix }}_codex_home:/root/.codex
        # Optional: forward host SSH agent into container for commit signing.
        # Set HOST_SSH_AGENT_SOCK before compose up.
        # - type: bind
        #  source: ${HOST_SSH_AGENT_SOCK:-/tmp/codex-no-ssh-agent}
        #  target: /ssh-agent
      environment:
        - GH_BOOTSTRAP_TOKEN=${GH_BOOTSTRAP_TOKEN:-}
        - OPENAI_API_KEY=${OPENAI_API_KEY:-}
        - WORKSTATION_DEBUG=${WORKSTATION_DEBUG:-false}
        - CODEX_HOME=/root/.codex
        # - SSH_AUTH_SOCK=/ssh-agent
        - ROLE_PROFILE={{ '${ROLE_PROFILE:-' + slug + '}' if not compose.profile else slug }}
        - ROLE_GITHUB_AUTH_MODE=${{ '{' + github_app.env_prefix + '_ROLE_GITHUB_AUTH_MODE:-app}' }}
        - ROLE_GITHUB_APP_ID=${{ '{' + github_app.env_prefix + '_ROLE_GITHUB_APP_ID:-' + (github_app.app_id_value|string) + '}' }}
        - ROLE_GITHUB_APP_INSTALLATION_ID=${{ '{' + github_app.env_prefix + '_ROLE_GITHUB_APP_INSTALLATION_ID:-' + (github_app.installation_id_value|string) + '}' }}
        - ROLE_GITHUB_APP_PRIVATE_KEY_PATH=${{ '{' + github_app.env_prefix + '_ROLE_GITHUB_APP_PRIVATE_KEY_PATH:-}' }}
        - WORKSPACE_REPO_OWNER=${WORKSPACE_REPO_OWNER:-Josh-Phillips-LLC}
        - WORKSPACE_REPO_URL=${{ '{' + github_app.env_prefix + '_WORKSPACE_REPO_URL:-https://github.com/Josh-Phillips-LLC/' + repo_name + '.git}' }}
        - WORKSPACE_REPO_DIR=/workspace/Projects/${{ '{' + github_app.env_prefix + '_WORKSPACE_REPO_DIR_NAME:-' + repo_name + '}' }}
        - ROLE_GIT_IDENTITY_NAME=${{ '{' + github_app.env_prefix + '_ROLE_GIT_IDENTITY_NAME:-' + git_identity.name + '}' }}
        - ROLE_GIT_IDENTITY_EMAIL=${{ '{' + github_app.env_prefix + '_ROLE_GIT_IDENTITY_EMAIL:-' + git_identity.email + '}' }}
        - AUTO_CLONE_WORKSPACE_REPO=${AUTO_CLONE_WORKSPACE_REPO:-true}
        - ALLOW_FALLBACK_INSTRUCTIONS=${ALLOW_FALLBACK_INSTRUCTIONS:-false}
  
      # Testing-mode autonomy
      cap_add:
        - ALL
      privileged: true
      init: true
      entrypoint: ["/usr/local/bin/init-workstation.sh"]
      command: ["sleep", "infinity"]
  
  compose_volume_declarations: |
    {{ compose.volume_prefix }}_projects_data:
    {{ compose.volume_prefix }}_gh_config:
    {{ compose.volume_prefix }}_git_config:
    {{ compose.volume_prefix }}_codex_home:
